\documentclass[a4paper]{article}
\usepackage[margin=1in]{geometry} 
\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage{url}
\usepackage{multirow}

\title{Peptide retention time prediction} 


\author{
Luminita Moruz\\
Science for Life Laboratory,\\
School of Biotechnology,\\
Royal Institute of Technology (KTH),\\
Stockholm, Sweden
\and
Lukas K\"{a}ll\\
Science for Life Laboratory,\\
School of Biotechnology,\\
Royal Institute of Technology (KTH),\\
Stockholm, Sweden}


\begin{document}

\maketitle

\setcounter{secnumdepth}{2} % organisational level that receives a numbers
\setcounter{tocdepth}{2}    % print table of contents for level 2
\tableofcontents            % print the table of contents
% levels are: 0 - chapter, 1 - section, 2 - subsection, 3 - subsubsection

\setlength{\parskip}{0.15cm}

\section{Introduction}

Mass spectrometry (MS) based methods are unquestionably the most
popular techniques for analyzing the protein content of biological
mixtures.  The ever-expanding palette of applications range from
identifying and quantifying proteins in biological samples
\cite{Geiger2012} to determining posttranslational modifications
\cite{Huttlin2010} and elucidating protein interaction networks
\cite{Gavin2011}.

Although available in a variety of flavors, most of the widely spread
MS-based workflows consists of the same main steps. First, the
proteins in the mixture of interest are cleaved into peptides using a
sequence-specific enzyme such as trypsin. In the next step, the
resulting peptides are separated according to their hydrophobicity on
a liquid chromatography (LC) column. As they gradually elute from the
column, the peptides are ionized via electrospray ionization and
subjected to mass spectrometry analysis. The result of these
measurements consists of a set of spectra, which are subsequently used
to infer valuable information about the proteins present in the
initial sample.

Today a majority of the mass spectrometry (MS) protocols in use have a
high-throughput, generating extensive amounts of data. This has
brought up a whole new set of analytical challenges, making the
development of efficient algorithms for data interpretation a major
area within proteomics research. A particular difficult challenge in
this context is posed by the tremendous complexity of the data.
Proteins display a wide range of physico-chemical properties and are
often found at very different amounts in complex samples, spanning as
much as 12 orders of magnitude in relative abundance~\cite{Angel2012}.
Furthermore, a large proportion of proteins are subjected to
posttranslational modifications~\cite{Lemeer2009}. To manage this
diversity, increasing efforts are made to extract besides the
fragmentation spectra additional information from each MS experiment.

An example of such additional information is represented by retention
times, {\em i.e.} the time points when peptides elute from the liquid
chromatography column.  The main purpose of liquid chromatography is
to reduce the number of peptides simultaneously injected into the mass
spectrometer. This increases the probability of each individual
peptide to be selected for fragmentation, which in its turn, increases
the proteome coverage achieved in an experiment.  However, besides
this, the separation process in itself provides useful information
about the analytes. On the one hand, the instrument always records the
time when a peptide elutes from the chromatography column, {\em i.e.}
the retention time. On the other hand, the retention time can also be
estimated by examining the sequence of the peptide. The availability
of both predicted and observed retention times has proven to be a
powerful feature, with several applications in MS-based proteomics
\cite{Palmblad2013}.

In this review we summarize the work done in the field of retention
time prediction, and describe a few of the successful applications of
such predictions. Section~\ref{sec:rplc} describes the basics of
peptide separation using reversed-phase liquid chromatography, while
Sections~\ref{sec:rtpred} and \ref{sec:rtpredm} summarize the main
approaches to retention time predictions from peptide
sequences. Section~\ref{sec:app} discusses some of the most important
applications of retention time predictions.
% Section~\ref{sec:irt} briefly introduces the use of peptide retention
% standards.


\section{\label{sec:rplc}Basics of peptide separation via reversed-phase liquid chromatography}
% main idea about RPLC 

At the moment, Reversed-Phase Liquid Chromatography (RPLC) is by far
the preferred method for separating peptides prior to mass
spectrometry analysis \cite{Xie201278}. This is mainly because the
method provides good resolution, gives reproducible results, and most
of all, is compatible with electrospray ionization. In virtually all
modern mass spectrometers the RPLC system can be easily connected to
the ionization source, such that the peptides can be automatically
transferred to mass spectrometry analysis as they elute from the
chromatography column.

In RPLC the peptides are separated according to their hydrophobicity
in a thin tube called chromatographic column. This tube is uniformly
packed with porous silica beads, such that there is as little
unoccupied space as possible between the particles. Each of the beads
contains hydrophobic chains attached. For peptide separation it is
common to use long alkyl chains such as C8 or C18, although other
options are also available. The packing of the column is commonly
denoted as the stationary phase.

Two types of solvents referred to as the mobile phase are used in
RPLC. By convention, these solvents are denoted A and B. Solvent A
refers to an aqueous buffer, typically composed of water and 0.1\%
acid. Solvent B generally consists of a large percentage of organic
solvent such as acetonitrile and 0.1\% acid. Any RPLC device includes
a mechanism to pump and mix the two solvents at precise proportions.

\begin{figure}[!h]
\centering
\includegraphics[trim=0.5cm 2.8cm 0.5cm 3.5cm, clip=true, width=0.8\textwidth]{img/rplc.pdf}
\caption{\label{fig:rplc} {\bf Principles of liquid chromatography.}
  The peptides mixed with mobile phase are injected on the column
  (Panel A). As an increasing amount of solvent B is mixed in, the
  peptides are released from the column in order of hydrophobicity
  (Panels B and C). The signal at the end of the column can be
  measured at each time point and displayed as a chromatogram (Panel
  D). Image adapted from www.lamondlab.com.}
\vspace{-7pt}
\end{figure}

During separation, the peptide mixture of interest is dissolved in
solvent A and injected onto the column. As they move through the
silica beads, peptides with different properties bind to the alkyl
chains with varying strengths. To release them from the column, an
increasing amount of solvent B is gradually mixed with buffer A and
pumped through the column (Figure~\ref{fig:rplc}). Each peptide is
released at a specific concentration of solvent B, and thus all the
individual molecules representing a peptide species elute at about the
same time.  Hence, if measuring the signal at the exit of the column,
a peak would be observed for each distinct peptide species.

The amount of time that a peptide needs to travel through the column
is called retention time, shortly $t_R$. One often uses the term
retention time to refer to the time corresponding to the apex of each
peptide's elution peak (Figure~\ref{fig:rplc}, Panel D). This time
point will be proportional to the peptide's ability to lower the
surface potential between the beads and the solvent, a property that
we normally refer to as the peptide's hydrophobicity.  Typically, the
more hydrophobic the peptide, the longer the retention time.

% say something about gradient and washing 
Since the elution of the peptides is determined by the proportion of
solvent B present at each time point, the scheme used to add solvent B
is an essential aspect of any RPLC experiment. Currently, the most
commonly used approach is based on {\em linear gradients}, where
the increase in solvent B follows a linear function. Most of the
peptides elute before the percentage of solvent B reaches 40\%, and
thus gradients often go from 2 to 40\% B. A high increase in
percentage B at the end of the run ensures that all the remaining
compounds are washed off from the column.

A great advantage of RPLC is its remarkable versatility. By altering a
variety of parameters such as column dimensions, the composition of
stationary and mobile phase, temperature or gradient slope, the method
can be adapted to separate a variety of compounds.

\section{\label{sec:rtpred}Retention time prediction for unmodified peptides}

Liquid chromatography gives reproducible results. Except for small
shifts from run to run, the same peptide elutes at about the same time
when a sample is reanalyzed under identical experimental conditions
(Figure~\ref{fig:repr}). This suggests that peptides engage in
well-defined interactions during separation, which depend only on the
experimental setup employed and the properties of the peptides
themselves. However, the properties of the peptides are determined to
a large extent by their amino-acid sequence. As a consequence, given a
chromatography setup, the sequence of a peptide should provide
virtually all the information needed to predict its retention time.


\begin{figure}[htbp]
\centering
\includegraphics[trim=0.5cm 0cm 2cm 1.5cm, clip=true, width=0.43\textwidth]{img/reproducibility.pdf}
\caption{\label{fig:repr} {\bf Reproducibility of peptide retention
    time.} Two identical shotgun proteomics experiments were carried
  out. The retention times of the peptides confidently identified in
  both runs are displayed. It should be noted that this relatively high reproducibility normally only appears between runs under near to identical experiments, and do not carry over into other experimental conditions or instrumentation.}
\end{figure}

However, in practice such predictive models is not as straight forward
as it might seem. For instance, one important part of such a model
would be the peptides three dimensional conformation. Although the
current structure prediction methods are quite accurate in predicting
three dimensional conformation of short amino acid chains, such
methods will not be equipped with the flexibility to model the various
conditions of a chromatographic experiment. For instance, many
peptides are likely changing their confirmation as a function of the
amount of organic solvent in the mobile phase, an effect that is
likely to have an important contribution to each peptides retention
time. Hence, most efforts to predict retention time have moved into
treating the chromatographic process as a black box, that is a system
that is only viewed in terms of its inputs an outputs. 
 
  
Following these observations,a variety of retention time prediction methods has been proposed. Most naturally one could divide these
methods into four classes: look-up tables-based approaches,
index-based methods, modeling-based methods and machine learning
techniques. The main ideas underlying each category are illustrated in
Figure \ref{fig:methods} , while Table \ref{tab:rtmethods} lists a few
of the most popular retention time prediction methods from each
category.

\begin{figure}[!h]
\centering \includegraphics[clip=true,
  width=0.8\textwidth]{img/methods.pdf}
\caption{\label{fig:methods} {\bf Retention time prediction methods.}
  Each figure illustrates a class of retention time prediction
  methods. The details of the different methods are described in
  detail in Section \ref{sec:rtpred}}.
\vspace{-7pt}
\end{figure}

\subsection{Methods based on look-ups of previous registered retention times}

These methods involve keeping a database of previously observed
retention times for a set of peptides, and subsequently use these
values as a basis for retention time predictions. In particular, in
the past years the use of retention standards has become increasingly
widespread \cite{olegstd, irt}. Such standards typically consist of a
small number of peptides covering a wide span of hydrophobicities and
favorable for detection by mass spectrometry. These peptides are often
analyzed together with the sample of interest, and by comparing their
observed and expected behaviors one can obtain valuable information
for a variety of applications.

\vspace{0.15cm}

As an example, in targeted proteomics, peptide standards can be used to
 calibrate predicted retention times and to estimate the accuracy of
 the prediction algorithms~\cite{Kiyonami01022011}. In addition,
 recent studies have reported excellent results when using peptide
 standards to adjust the time when certain transitions are scheduled
 ``on-the-fly''~\cite{seb, irt}. Retention standards are also useful
 for aligning data from multiple experiments~\cite{petritis2003}, to
 transfer retention times between different chromatography
 setups~\cite{seb}, or to keep track of the performance of LC-MS/MS
 systems~\cite{qcal}.

\subsection{Index-based methods}
\label{sec:irt}
\hyphenation{lear-ning}
\hyphenation{indivi-dual}

% Basic idea 
Index-based prediction methods aim at estimating the effect that each
individual amino acid in a sequence has on the retention time of the
peptide. The individual contributions of the amino acids are often
referred to as retention coefficients, and a set of retention
coefficients forms a retention index. Once a retention index is
derived for a given chromatography system, the retention time of a
peptide can be estimated by simply summing up the retention
coefficients of the constituent amino acids.

% The first method 
The first method to implement this idea used a set of 25 short
peptides together with their observed retention times to derive
retention coefficients for each of the amino acids and end groups
present in the sequences \cite{meek1980}. The coefficients were
calculated using a form of iterative regression and were estimated
using only the amino-acid composition of the peptides, without any
information about the position of each amino acid in the
sequence. However, since shuffled versions of the same peptide
sequence had previously been separated on a RPLC column, the author
pointed out that additional parameters would be required for
predicting the retention time of longer peptides.


\begin{table}
 \caption{{\bf Retention time prediction methods.} We
   give a few of the most commonly used retention time prediction methods available.}
 \vspace{.2cm}
 \label{tab:rtmethods}
 \begin{tabular}{lp{9cm}l}

 Method name & Link & References  \\
 \hline
SSRCalc & \url{http://hs2.proteome.ca/SSRCalc/SSRCalcX.html} & \cite{Krokhin2004, Krokhin2006}, \cite{Spicer2007} \\
BioLCCC & \url{http://theorchromo.ru/} & \cite{gorshkov2006} \\
% ANN & Link? & \cite{petritis2003,petritis2006improved} \\
RTPredict &  \url{ http://ftp.mi.fu-berlin.de/OpenMS/documentation/html/TOPP_RTPredict.html}, 
 & \cite{rtpredict, rtpredictImproved} \\
RTModel &\url{http://ftp.mi.fu-berlin.de/OpenMS/documentation/html/TOPP_RTModel.html}  & \cite{rtpredict, rtpredictImproved} \\

{\sc Elude} & \url{http://elude.sbc.su.se/} & \cite{elude1, elude2} \\
iRT-calculator & \url{http://www.biognosys.ch/products/irt-calculator.html} & \cite{irt} \\
\hline
 \end{tabular} \\
\end{table}

%The study reported good correlations between predicted and observed
%retention times, showing that for short peptides the amino acid
%composition provided sufficient information to produce reasonable
%retention time predictions.



% It became available that additional information is needed; anc oclumn is important  examples 
Indeed, a subsequent study showed that even for short peptides,
distinct retention coefficients are obtained when an amino acid is
located at different positions in a sequence \cite{Houghten1987}. In
this context, the authors speculated that different retention
coefficients would be needed for each position in a peptide
sequence. Although the exact chemical mechanisms underlying this
observation are still not fully understood, a number of studies have
pinpointed individual factors that alter the retention coefficients of
amino acids. As an example, it has been shown that the retention
contribution of an amino acid is affected by the overall
hydrophobicity of the peptide \cite{Mant2006}, the number of positive
charges \cite{Mant2006} or presence of elements of secondary
structure \cite{Zhou1990}. In addition, modifications in
chromatography setup such as changing the composition of the mobile or
stationary phases also modify the elution pattern of the
peptides \cite{Browne1982, Guo1987, Gilar2010}.


% SSRcalc was proposed including a number of additional terms; then it was extended
% for a few other column
Following these observations, Krokhin {\em et al.} developed {\sc
SSRCalc} \cite{Krokhin2004}, which is currently the most widely used
index-based retention time predictor. In the initial version of the
algorithm a collection of 346 tryptic peptides was used to derive two
sets of retention coefficients, one corresponding to the N-terminal
and one to all the other positions in a peptide sequence. Furthermore,
correction factors for peptide length and overall hydrophobicity were
included. Subsequent versions of the algorithm included terms
accounting for additional properties such as isoelectric point,
nearest-neighbor effects of charged peptides and propensity to form
helical structures \cite{Krokhin2006}. Recently, it was showed that
interactions involving helical structures are highly complex, and thus
more sophisticated models are needed to account for the effects that
such interactions have on peptide retention time \cite{ah}.

A limitation of index-based methods are that they are optimized for
predicting retention times for certain chromatography setups. Thus,
their prediction ability deteriorates for experimental conditions
diverging from the setup on which the algorithm was optimized
\cite{Spicer2007}. Consequently, more advanced methods such as {\sc
Elude} \cite{elude1,elude2} estimates retention time indices for each
dataset as hand. In these cases the indeces are used to generate
features that are used as an input for final retention time
estimates. We will come back to this in section \ref{sec:ML}. 


% - sum of retention coefficients (Meek reference 22) - different RT
% coefficients and the observation that this coefficients depend on
% the chromatography system (Browne ref 24) - investogate the
% contribution of individual amino acids (Guo 26,27) - all the work
% above was done on synthetic peptides os simple samples. Then RT
% prediction for complex sa% mples was proposed by (Palmblad 28-30) -
% important the exact position of each aa (pref 27) - additional rules
% included peptide length (ref 32), position of K and R residues [ref
% 33], and in the e% nd that the position of each amino acid at each
% position is important [ref 34] - amphipathicity [ref 35] - SSRCalc
% [ref 36-39]


\subsection{Modeling-based approaches}

Modeling-based techniques predict retention times by using information
about the structure of the peptides and/or their chemical interactions
during separation. An example is the methods based on Quantitative
Structure-Retention Relationships (QSRR) \cite{Kaliszan2005,
Baczek2005}. In such approaches specialized molecular modeling
software is used to calculate a number of chemical descriptors from
the peptide sequence. The most relevant such descriptors are then
selected and combined via regression analysis into a prediction
function, which is subsequently used to estimate retention time for
other peptides of interest.

In other modeling-based approaches theoretical models are used to
capture the chemical behavior of peptides on the chromatography
column. One such method is BioLCCC, models the chromatography process
using a lattice based random walk model for the peptides, which are
modeled as chains of monomers. The model also includes an entropy and
energy compensation for the amount of peptides residing on the column 
and a model of the interaction energies between the peptide and the
stationary phase. 

Nevertheless, given the numerous factors involved in peptide
separation, modeling approaches often involve a considerable number of
simplifications.
 
\subsection{Machine learning-based methods}
\label{sec:ML}

Machine learning-based approaches use a set of training peptides, {\em
  i.e.} peptide sequences with known retention times, to estimate the
parameters of a predefined mathematical model. This step is typically
called fitting, training or learning. Once trained, the mathematical
model can be subsequently used to predict retention time for other
peptides of interest.


One of the first machine learning approaches for retention time
prediction was based on an Artificial Neural Network
(ANN) \cite{petritis2003}. Initially, each peptide was described by 20
features giving the number of each of the 20 amino acid residues
present in the sequence. The network was trained using $\sim$7000
peptides with known retention times and evaluated using a set of
$\sim$5000 peptides originating from another organism. 

In a follow-up work, the method was extended by representing each
peptide by 1052 instead of 20 features
\cite{petritis2006improved}. The new descriptors encoded the identity
of each amino acid at each position in a sequence, as well as the
length and the hydrophobic moment of the peptide. The new neural
network was trained on more than 300,000 peptide sequences. To obtain
such a large number of peptides with known retention times, a strategy
to normalize elution times was developed. This allowed pooling of
peptides identified in more than 12,000 shotgun experiments. The
trained algorithm reported better performance for the 1303 peptides
on which it was evaluated, than its predecesor.


A drawback of the method was however the large amount of training
peptides required, which made the algorithm difficult to retrain for
other chromatographic conditions. This was a serious limitation in the
context of RPLC separation, where a broad variety of chromatographic
setups is commonly used across research laboratories. To address this,
Klammer {\em et al.} proposed a predictor based on support vector
machines (SVMs) \cite{klammer2007improving}. Their method required
fewer training peptides and could thus be easily adapted to new
chromatographic conditions, but yielded lower prediction accuracy.
Subsequently, a more elaborate SVM-based method, {\sc RTPredict}, that
 use a customized kernel function was proposed \cite{rtpredict,
rtpredictImproved}. This approach provided an algorithm that required
as little as 50 peptides for training.

% Other retention time prediction method used a feature selection
% approach to select relevant descriptors, and showed good
% performances even for longer peptides containing up to 50 amino
% acids \cite{shinoda2006}.

Moruz {\em et al.}~\cite{elude1} developed a software package for
retention time prediction named {\sc Elude}. One of the main novelty
points of {\sc Elude} was the calculation of peptide features based on
both a general hydrophobicity index, as well as a retention index
trained for each dataset at hand. The features included properties
such as average hydrophobicity, the N- and C-termini's hydrophobicity,
the stretch of the five most and least hydrophobic amino acids,
helicity, and the number of occurrences of the 25\% most or least
hydrophobic amino acids. This ensured that the algorithm could be
applied to different chromatography setups with minimal loss in
performance. For cases when little training data was available, {\sc
Elude} implemented an additional workflow based on a library of
pre-trained retention models. This workflow required only a few tens
of training peptides to select and calibrate the most suitable model
from the library. Both the selection and calibration were performed
using statistical methods robust to outliers. 


In a benchmark based on the merit of how large retention time window,
measured as a fraction of the gradient time was be needed to include
95\% of the peptides of a series of 14 runs, {\sc Elude} outperformed
{\sc SSRCalc} and {\sc RTPredict}, needing only on average 22\% as
compared to 28\% and 26\% respectively~\cite{elude1}. However, despite
all these efforts, it should be pointed out that none of the retention
time prediction methods currently available is able to provide a
prediction precision comparable to the small shifts observed when
comparing retention time of peptides from two technical replicates
(Figure \ref{fig:repr}). Recently, the lack of suitable
representations for secondary structure elements was indicated as one
of the main causes of prediction errors \cite{Reimer2012}.  Most
probably additional factors are involved, and further studies are
required to even understand the error sources in the process.

\section{\label{sec:rtpredm}Retention time prediction for modified peptides}

% very few studies have documented the chromatographic behavior of
% modified peptides
The study of peptide separation mechanisms in RPLC has been an active
area of research for the past 30 years. Nonetheless, surprisingly
little efforts have been directed toward investigating the
chromatographic behavior of posttranslationally modified peptides. The
few studies available so far have mostly focused on phosphorylated
peptides \cite{Kim2007}, or a couple of artifactual modifications
commonly introduced during sample preparation
\cite{Reimer2011}. Consequently, few retention time prediction methods
have been extended and assessed for such peptides. A majority of the
approaches currently available are modification-specific, many of them
developed specifically for phosphopeptides \cite{Kawakami2005,
  perlova2010}.

\begin{figure}[!h]
\centering 
\includegraphics[width=0.9\textwidth]{img/elude-ptm.pdf}
\caption{\label{fig:elude} {\bf {\sc Elude}'s workflow.}  {\sc Elude} encompasses two learning steps. In the first one the training peptides are used to build an in-house retention index. This index, together with additional information, is then employed to calculate a set of 60 numerical features for each peptide. These features are optimally combined during a second training procedure. The resulting retention model can be subsequently used to predict the retention time of other peptides of interest.}
\end{figure}

To address this, in Moruz {\em et al.} \cite{elude2} extended the
first version of their algorithm {\sc ELUDE} to encompass modified
peptides as well. This was straightforward to achieve once the authors
observed that many of their predictive features of their method were
all functions of the peptides amino acid sequence and a retention
index. As such retention indices are estimated for each dataset at
hand, at the beginning of the training procedure, they can trivially
be extended beyond the standard amino acids. When the authors used but
the features based on their retention time index, they obtained a
negligible loss in accuracy compared to using all their original
features for unmodified peptides. Since this index was trained for
each dataset at hand, the algorithm became fully trainable for any
modified amino acid (Figure \ref{fig:elude}). The new version of {\sc
ELUDE} was evaluated on peptides containing artifactual modifications
introduced as part of an MS protocol called COmbined FRActional
DIagonal Chromatography (COFRADIC) \cite{Gevaert2002}. The results
showed that {\sc ELUDE} yielded equally accurate predictions for
modified and unmodified peptides \cite{elude2}.

As large-scale studies of a variety of posttranslational modifications
increasingly come within reach, predictors
handling other modifications will become available. In this context,
machine learning methods are expected to play an important role
because of their flexibility and intrinsic ability to adapt to new
datasets.


\section{\label{sec:app}Applications of retention time prediction}

% RT prediction is used to increase number of identifications 
The time points when peptides elute from the RPLC column are typically
recorded in MS experiments. By comparing these values with predicted
retention times for peptides from a sequence database, information
about the identity of the peptides can be obtained. This relatively
straightforward idea has been implemented in a variety of flavors and
was proven to bring significant improvements in the peptide
identification process.


Palmblad {\em et al.} showed that matching theoretical and observed
masses and retention times provides a simple, yet powerful method to
identify peptides in simple biological mixtures
\cite{palmblad2002prediction}. Strittmatter {\em et al.} used
retention time as a parameter in a discriminant function that
differentiated between correct and incorrect peptide identifications
\cite{Strittmatter2004}. Following this approach, they reported
$\sim$9\% more confident peptide identifications in a typical shotgun
experiment. Along the same lines, Klammer {\em et al.} demonstrated
that for specific experimental conditions, just filtering out peptides
with large deviations between observed and predicted retention time
leads to up to 50\% more identifications \cite{klammer2007improving}. 



Moruz {\em et al.} also investigated the possibility to use predicted
retention times to increase the throughput of proteomics
experiments. Their starting point was the observation that in typical
shotgun proteomics experiments only a small fraction of the detected
ions is fragmented, and thus used to identify peptides. The remaining
unfragmented ions are usually disregarded in the subsequent data
analyses. In the light of these observations, they investigated
whether we could use information encapsulated by unfragmented ions to
improve the protein inference in shotgun proteomics \cite{mf}.



% how it works and main results
More specifically, they matched observed masses and retention times of
unfragmented ions to predicted masses and retention times for the
theoretical peptides from an {\it in silico} digest. They built a
statistical framework to assign protein probabilities based on these
matches, and combined the results with the ones obtained by the
typical workflow based on fragmented ions. Following this approach, they
obtained up to 7\% more protein identifications at a fixed false
discovery rate threshold of 1\% \cite{mf}.

The idea of identifying proteins based on entire peptides, rather than
peptide fragments, is not new. In fact, this was the principle
underlying peptide mass fingerprinting, one of the first methods used
to identify proteins via mass spectrometry. However, when introduced
in the 90's, mass fingerprinting could not be applied to unequivocally
identify proteins in complex biological samples. Consequently, shotgun
proteomics has gained popularity instead. Nevertheless, with great
developments in instrumentation leading to sub-ppm mass accuracy, the
possibility of using mass fingerprinting-like methods came back to
attention~\cite{iamt1}. The mentioned study showed how improved mass
accuracy and retention time predictions enable the use of unfragmented
ions even in the context of complex peptide mixtures.

Krokhin {\em et al.} illustrated yet another route to employ retention time
predictions \cite{krokhin200612, McQueen2012}. They showed that
theoretical retention times and mass measurements can be used to
define lists of peptides belonging to already identified proteins. The
instrument can be instructed to avoid fragmenting these peptides, thus
decreasing the number of fragmentation events that need to be acquired
for identifying a set of proteins.

% Improve the design of SRM experiments 
In addition, predicted retention times are useful investigating the
elution properties of the peptides.  To illustrate this, in
\cite{elude1} the retention time of all the theoretical peptides from
an {\it in silico} digest of the human proteome were predicted using
{\sc ELUDE}. This exercise revealed a rather skewed distribution, with
a majority of the peptides eluting in only a small portion of the
chromatography run. This suggested that the linear gradient typically
used in liquid chromatography are sub-optimal, and that one should be
able to replace such gradients with nonlinear functions that produce
even distributions of the peptides across runs.

This hypothesis was tested by calculating and evaluating two types of
nonlinear gradients \cite{gradopt1}. The results showed that the new
gradients not only provided more uniform distributions of the
peptides, but also led to an increase in the number of peptide
identifications. In addition, they facilitated the identification of
different peptide species compared to the typical linear gradients. To
allow the easy calculation of nonlinear gradients by any MS
practitioner, a user-friendly graphical user interface was implemented 
\cite{gradopt2}.  Seen from a general perspective, this showed that
the gradient function is yet another parameter that researchers can
alter in their experiments, opening up a whole new range of potential
applications.

Other examples of applications of retention time predictions include
the optimization of {\em de novo} targeted proteomic assays
\cite{bertsch2010}, as well as decreasing the number of candidate
peptides during database searching \cite{lobas2013} and accurate
simulations of MS-based experiments \cite{bielow2011}.


%\begin{figure}[!h]
%\centering 
%\includegraphics[width=0.8\textwidth]{grad.pdf}
%\caption{\label{fig:svm} {\bf Workflow to calculate nonlinear gradients.} We calculated two types of nonlinear gradients: one that evens out the predicted distribution of the peptides from an {\it in silico} digest of the proteome, and one that uniformizes the distribution of the abundant MS1-ions.}
%\end{figure}

% It is an orthogonal information. Decrease the database search space,
% study properties of the peptides
 
%\section{\label{sec:irt}Peptide retention standards}

%\hyphenation{wide-spread}
% peptide standards what they are, what they are used for 
%In the past years, the use of retention standards has become
%increasingly widespread in the context of mass spectrometry-based
%proteomics~\cite{olegstd, irt}. Such standards typically consist of a
%small number of peptides covering a wide span of hydrophobicities and
%with well studied behaviors under LC-MS/MS. These peptides are often
%analyzed together with the sample of interest, and by comparing their
%observed and expected behaviors one can obtain valuable information
%for a variety of applications.



%As an example, in targeted proteomics peptide standards can be used to
% calibrate predicted retention times and to estimate the accuracy of
% the prediction algorithms~\cite{Kiyonami01022011}. In addition,
% recent studies have reported excellent results when using peptide
% standards to adjust the time when certain transitions are scheduled
% ``on-the-fly''~\cite{seb, irt}. Retention standards are also useful
% for aligning data from multiple experiments~\cite{petritis2003}, to
% transfer retention times between different chromatography
% setups~\cite{seb}, or to keep track of the performance of LC-MS/MS
% systems~\cite{qcal}.

\section{Discussion}

The accuracy of the machine learning-based methods described in
section \ref{sec:ML} is still much lower than the methods based on
look-ups of previously registered retention times. However, the large
availability of datasets suggests that one possibility to increase the
accuracy of retention time predictions could rely on the use of
enhanced machine learning methods. Currently, there are a number of
such techniques that have not yet been applied to the problem of
predicting peptides' retention time. Here we will bring up one such
technique called pairwise Machine-Learned Ranking (MLR)
\cite{liu2009learning}, which we feel is particularly suitable for
this problem. MLR models can be trained to determine which of two data
points should be better ranked. 

MLR has traditionally been used for construction of ranking models for
information retrieval systems. However, in the case of retention time
prediction, we can use such a predictor to estimate the elution order
for sets of peptides. While such information can be useful in its own
\cite{bailey2012instant}, it can also be converted into absolute
retention times, given that the distribution of the retention times is
known.

It is also worth noting that the current trend of processing huge data
repositories, frequently referred to as big data, have brought into
attention so called deep learning techniques such as belief networks
using restricted multiple layered Boltzmann machines (RBM)
\cite{salakhutdinov2009deep} or deep neural networks. This follows the
observation that the performance of predictors is often enhanced if
one can structure the prediction into multiple layers. The drawback of
such models are that they require large training sets. Given the very
large sets of peptides with retention times that are assembled in
various repositories, such as Peptide Atlas
\cite{desiere2006peptideatlas} and PRIDE \cite{martens2005pride}, such
methods could probably be implemented for retention time prediction as
well.

The available technologies to infer peptides and proteins from mass
spectrometry data involve predicting the the potential manifestations
of the analyzed peptides, such as their fragmentation pattern, and
comparing those predicted properties to the observed data. Such
comparisons are regularly done for discovery proteomics by search
engines. However, an attractive way to increase the sensitivity of the
inference procedure is to also predict properties such as their
iso-electric point~\cite{perez2011silico,branca2014hirief} or of
particular interest for this review, chromatographic retention time
\cite{cerqueira2010mude}. One way to determie a predicatble sparation
techniques usefulness is to estimate its ability to remove candidate
peptides of any detected feature, normally measured by a false
positive ratio (FPR), also known as the methods fall-out. Current
retention time prediction algorithms have an FPR of about
$\frac{1}{5}$, meaning that it can remove about four out of five
candidate peptides for a given feature. This could be compared to the
FPR of about $\frac{1}{200}$ for predictions of high-resolution
iso-electric focusing experiments~\cite{branca2014hirief}. The
retention time prediction have toimprove quite a bit to come to level
with the fall-out of iso-electric focusing, however, almost all mass
spectrometry-based proteomics use reversed phase chromatography, while
very few studies are using iso-electric focusing.

% An estimate of a FPR for MS1's would be great here.

Moreover, targeted proteomics experiments, such as Selected Reaction
Monitoring (SRM), are dependent on the predictability of a peptide's
behavior. In such experiments the retention times and the suitable
transitions are needed as input to the analysis. Frequently, such
information is derived from previous shotgun analysis. As the capacity
of targeted proteomics experiments expands by the introduction of the
more comprehensive data independent acquisition techniques
\cite{Venable2004} (a.k.a. SWATH analysis), such pre-identification of
peptide transitions and retention times threatens to become a limiting
factor. Our current methods to identify peptides from Data Independent
Acquisition are only as comprehensive as the previous shotgun analysis
would be. An attractive alternative is to predict retention time and
transition using {\em de novo} predictions from the peptides amino
acid sequences.  Such a system of identifications not dependent on
previous peptide identifications from shotgun proteomics experiments
would lead to a more direct experimental design and hopefully to more
comprehensive coverage. Thus {\em de novo} retention time predictions
have an important role to fill.

% Might be good to add something about that the relatively low
% accuracy in our predictions, there should be some room for
% improvements in the near future.

\bibliographystyle{unsrt}
\bibliography{./retention.bib}


\end{document}

%%  LocalWords:  hydrophobicity chromatography elute peptides physico
%%  LocalWords:  electrospray spectrometry analytical proteomics RPLC
%%  LocalWords:  posttranslational phosphorylation proteome analytes
%%  LocalWords:  peptide elutes amino tryptic isoelectric SSRCacls et
%%  LocalWords:  workflows trypsin hydrophobicities chromatographic
%%  LocalWords:  alkyl peptide's elution SSRCalc BioLCCC RTModel iRT
%%  LocalWords:  RTPredict Krokhin al QSRR Klammer SVMs SVM Moruz pre
%%  LocalWords:  dataset workflow outliers posttranslationally silico
%%  LocalWords:  phosphorylated artifactual phosphopeptides COmbined
%%  LocalWords:  FRActional DIagonal COFRADIC datasets Palmblad
%%  LocalWords:  Strittmatter unfragmented
